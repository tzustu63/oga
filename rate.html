<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>113å­¸å¹´åº¦å„å¤§å°ˆæ ¡é™¢å¤–ç±å­¸ç”Ÿæ¯”ä¾‹åˆ†æ</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        body {
            font-family: 'Microsoft JhengHei', Arial, sans-serif;
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        .container {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        h1 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 30px;
            border-bottom: 3px solid #3498db;
            padding-bottom: 15px;
            font-size: 2.2em;
        }
        .summary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        .summary-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        .summary-number {
            font-size: 2.5em;
            font-weight: bold;
            display: block;
            margin-bottom: 10px;
        }
        .summary-label {
            font-size: 1.1em;
            opacity: 0.9;
        }
        .export-section {
            text-align: center;
            margin-bottom: 30px;
        }
        .export-btn {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 16px;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s;
            margin: 0 10px;
            box-shadow: 0 5px 15px rgba(40, 167, 69, 0.3);
        }
        .export-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(40, 167, 69, 0.4);
        }
        .controls {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }
        .sort-btn {
            background: linear-gradient(135deg, #3498db 0%, #2980b9 100%);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s;
        }
        .sort-btn:hover, .sort-btn.active {
            background: linear-gradient(135deg, #2980b9 0%, #3498db 100%);
            transform: translateY(-2px);
        }
        .table-container {
            overflow-x: auto;
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            max-height: 600px;
            overflow-y: auto;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            background: white;
        }
        th {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px;
            text-align: center;
            font-weight: bold;
            position: sticky;
            top: 0;
            z-index: 10;
        }
        td {
            padding: 12px 15px;
            text-align: center;
            border-bottom: 1px solid #eee;
        }
        tr:nth-child(even) {
            background-color: #f8f9fa;
        }
        tr:hover {
            background: linear-gradient(135deg, #e3f2fd 0%, #f1f8e9 100%);
            transition: all 0.3s;
        }
        .rank {
            font-weight: bold;
            color: #2c3e50;
        }
        .school-name {
            text-align: left;
            font-weight: 500;
            color: #2c3e50;
            max-width: 200px;
        }
        .percentage {
            font-weight: bold;
            font-size: 1.1em;
        }
        .high-percentage {
            color: #e74c3c;
            background: rgba(231, 76, 60, 0.1);
            padding: 5px 10px;
            border-radius: 15px;
        }
        .medium-percentage {
            color: #f39c12;
            background: rgba(243, 156, 18, 0.1);
            padding: 5px 10px;
            border-radius: 15px;
        }
        .low-percentage {
            color: #27ae60;
            background: rgba(39, 174, 96, 0.1);
            padding: 5px 10px;
            border-radius: 15px;
        }
        .student-count {
            color: #3498db;
            font-weight: 500;
        }
        .analysis-section {
            margin-top: 30px;
            padding: 25px;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 15px;
        }
        .analysis-title {
            color: #2c3e50;
            font-size: 1.5em;
            margin-bottom: 15px;
            text-align: center;
        }
        .insight-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }
        .insight-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.1);
        }
        .insight-title {
            color: #3498db;
            font-weight: bold;
            margin-bottom: 10px;
        }
        .loading {
            text-align: center;
            padding: 50px;
            color: #666;
            font-size: 18px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>113å­¸å¹´åº¦å„å¤§å°ˆæ ¡é™¢å¤–ç±å­¸ç”Ÿæ¯”ä¾‹åˆ†æ</h1>
        
        <div class="summary-grid">
            <div class="summary-card">
                <span class="summary-number" id="totalSchools">133</span>
                <span class="summary-label">çµ±è¨ˆå­¸æ ¡æ•¸</span>
            </div>
            <div class="summary-card">
                <span class="summary-number" id="totalForeignStudents">77,531</span>
                <span class="summary-label">å¤–ç±å­¸ç”Ÿç¸½æ•¸</span>
            </div>
            <div class="summary-card">
                <span class="summary-number" id="totalStudents">1,055,580</span>
                <span class="summary-label">ç¸½å­¸ç”Ÿäººæ•¸</span>
            </div>
            <div class="summary-card">
                <span class="summary-number" id="overallPercentage">7.34%</span>
                <span class="summary-label">æ•´é«”å¤–ç±å­¸ç”Ÿæ¯”ä¾‹</span>
            </div>
        </div>

        <div class="export-section">
            <button class="export-btn" onclick="exportToExcel()">ğŸ“Š åŒ¯å‡ºExcelæª”æ¡ˆ</button>
            <button class="export-btn" onclick="exportToCSV()">ğŸ“„ åŒ¯å‡ºCSVæª”æ¡ˆ</button>
        </div>

        <div class="controls">
            <button class="sort-btn active" onclick="sortByPercentage()">æŒ‰æ¯”ä¾‹æ’åº</button>
            <button class="sort-btn" onclick="sortByForeignNumber()">æŒ‰å¤–ç±å­¸ç”Ÿäººæ•¸æ’åº</button>
            <button class="sort-btn" onclick="sortByTotalNumber()">æŒ‰ç¸½å­¸ç”Ÿæ•¸æ’åº</button>
            <button class="sort-btn" onclick="sortByName()">æŒ‰å­¸æ ¡åç¨±æ’åº</button>
        </div>

        <div class="table-container">
            <table id="analysisTable">
                <thead>
                    <tr>
                        <th>æ’å</th>
                        <th>å­¸æ ¡åç¨±</th>
                        <th>å¤–ç±å­¸ç”Ÿæ¯”ä¾‹</th>
                        <th>å¤–ç±å­¸ç”Ÿäººæ•¸</th>
                        <th>ç¸½å­¸ç”Ÿäººæ•¸</th>
                    </tr>
                </thead>
                <tbody id="tableBody">
                    <tr><td colspan="5" class="loading">æ­£åœ¨è¼‰å…¥è³‡æ–™...</td></tr>
                </tbody>
            </table>
        </div>

        <div class="analysis-section">
            <div class="analysis-title">æ•¸æ“šæ´å¯Ÿ</div>
            <div class="insight-grid">
                <div class="insight-card">
                    <div class="insight-title">é«˜æ¯”ä¾‹å­¸æ ¡ç‰¹å¾µ</div>
                    <div>å¤–ç±å­¸ç”Ÿæ¯”ä¾‹è¶…é20%çš„å­¸æ ¡å¤šç‚ºæŠ€è·é™¢æ ¡ï¼Œé¡¯ç¤ºæŠ€è·æ•™è‚²å°åœ‹éš›å­¸ç”Ÿçš„å¸å¼•åŠ›ã€‚æ’åå‰äº”çš„å­¸æ ¡æ¯”ä¾‹éƒ½è¶…é25%ã€‚</div>
                </div>
                <div class="insight-card">
                    <div class="insight-title">è¦æ¨¡èˆ‡åœ‹éš›åŒ–</div>
                    <div>å¤§å‹ç¶œåˆå¤§å­¸å¦‚å°å¤§ã€æˆå¤§é›–ç„¶å¤–ç±å­¸ç”Ÿäººæ•¸çœ¾å¤šï¼Œä½†å› ç¸½å­¸ç”Ÿæ•¸é¾å¤§ï¼Œæ¯”ä¾‹ç›¸å°è¼ƒä½ï¼Œç´„åœ¨8-10%ä¹‹é–“ã€‚</div>
                </div>
                <div class="insight-card">
                    <div class="insight-title">æŠ€è·æ•™è‚²å„ªå‹¢</div>
                    <div>è¨±å¤šç§‘æŠ€å¤§å­¸å’ŒæŠ€è¡“å­¸é™¢åœ¨å¤–ç±å­¸ç”Ÿæ¯”ä¾‹ä¸Šè¡¨ç¾çªå‡ºï¼Œåæ˜ å°ç£æŠ€è·æ•™è‚²åœ¨åœ‹éš›ä¸Šçš„ç«¶çˆ­åŠ›ã€‚</div>
                </div>
                <div class="insight-card">
                    <div class="insight-title">æ•´é«”è¶¨å‹¢</div>
                    <div>å…¨å°å¹³å‡å¤–ç±å­¸ç”Ÿæ¯”ä¾‹ç‚º7.34%ï¼Œé¡¯ç¤ºå°ç£é«˜ç­‰æ•™è‚²åœ‹éš›åŒ–ç¨‹åº¦æŒçºŒæå‡ï¼Œå¸å¼•è¶Šä¾†è¶Šå¤šåœ‹éš›å­¸ç”Ÿä¾†å°å°±å­¸ã€‚</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // å¤–ç±å­¸ç”Ÿåˆ†æè³‡æ–™
        const foreignStudentData = [
            {rank: 1, name: "æ•å¯¦ç§‘æŠ€å¤§å­¸", percentage: 48.09, foreignStudents: 515, totalStudents: 1071},
            {rank: 2, name: "å°é‹¼ç§‘æŠ€å¤§å­¸", percentage: 41.53, foreignStudents: 515, totalStudents: 1240},
            {rank: 3, name: "æ±å—ç§‘æŠ€å¤§å­¸", percentage: 38.72, foreignStudents: 1377, totalStudents: 3556},
            {rank: 4, name: "é–‹å—å¤§å­¸", percentage: 27.34, foreignStudents: 1286, totalStudents: 4703},
            {rank: 5, name: "å—é–‹ç§‘æŠ€å¤§å­¸", percentage: 26.25, foreignStudents: 640, totalStudents: 2438},
            {rank: 6, name: "è‚²é”ç§‘æŠ€å¤§å­¸", percentage: 25.78, foreignStudents: 873, totalStudents: 3386},
            {rank: 7, name: "é»æ˜æŠ€è¡“å­¸é™¢", percentage: 25.45, foreignStudents: 1253, totalStudents: 4924},
            {rank: 8, name: "é†’å¾ç§‘æŠ€å¤§å­¸", percentage: 23.30, foreignStudents: 1313, totalStudents: 5634},
            {rank: 9, name: "å´‘å±±ç§‘æŠ€å¤§å­¸", percentage: 22.90, foreignStudents: 1872, totalStudents: 8173},
            {rank: 10, name: "é¾è¯ç§‘æŠ€å¤§å­¸", percentage: 22.88, foreignStudents: 2595, totalStudents: 11340},
            {rank: 11, name: "æ˜æ–°ç§‘æŠ€å¤§å­¸", percentage: 22.05, foreignStudents: 2185, totalStudents: 9909},
            {rank: 12, name: "å³é³³ç§‘æŠ€å¤§å­¸", percentage: 21.10, foreignStudents: 830, totalStudents: 3933},
            {rank: 13, name: "å¾·è‚²è­·ç†å¥åº·å­¸é™¢", percentage: 20.68, foreignStudents: 655, totalStudents: 3167},
            {rank: 14, name: "è‡ºåŒ—åŸå¸‚ç§‘æŠ€å¤§å­¸", percentage: 20.39, foreignStudents: 1790, totalStudents: 8778},
            {rank: 15, name: "æ™¯æ–‡ç§‘æŠ€å¤§å­¸", percentage: 19.98, foreignStudents: 870, totalStudents: 4354},
            {rank: 16, name: "å¾·æ˜è²¡ç¶“ç§‘æŠ€å¤§å­¸", percentage: 19.54, foreignStudents: 994, totalStudents: 5086},
            {rank: 17, name: "å®åœ‹å¾·éœ–ç§‘æŠ€å¤§å­¸", percentage: 18.73, foreignStudents: 804, totalStudents: 4292},
            {rank: 18, name: "ä¿®å¹³ç§‘æŠ€å¤§å­¸", percentage: 18.02, foreignStudents: 605, totalStudents: 3358},
            {rank: 19, name: "æ³•é¼“æ–‡ç†å­¸é™¢", percentage: 17.95, foreignStudents: 70, totalStudents: 390},
            {rank: 20, name: "è–ç´„ç¿°ç§‘æŠ€å¤§å­¸", percentage: 16.92, foreignStudents: 79, totalStudents: 467},
            {rank: 21, name: "è¬èƒ½ç§‘æŠ€å¤§å­¸", percentage: 15.84, foreignStudents: 1248, totalStudents: 7881},
            {rank: 22, name: "å¥è¡Œç§‘æŠ€å¤§å­¸", percentage: 14.73, foreignStudents: 1293, totalStudents: 8777},
            {rank: 23, name: "å…ƒåŸ¹é†«äº‹ç§‘æŠ€å¤§å­¸", percentage: 14.17, foreignStudents: 506, totalStudents: 3571},
            {rank: 24, name: "å»ºåœ‹ç§‘æŠ€å¤§å­¸", percentage: 12.95, foreignStudents: 453, totalStudents: 3497},
            {rank: 25, name: "ç¾©å®ˆå¤§å­¸", percentage: 12.70, foreignStudents: 1388, totalStudents: 10932},
            {rank: 26, name: "æœé™½ç§‘æŠ€å¤§å­¸", percentage: 12.25, foreignStudents: 1091, totalStudents: 8954},
            {rank: 27, name: "ä¸­è¯ç§‘æŠ€å¤§å­¸", percentage: 12.01, foreignStudents: 344, totalStudents: 2866},
            {rank: 28, name: "åœ‹ç«‹è‡ºç£ç§‘æŠ€å¤§å­¸", percentage: 11.16, foreignStudents: 1322, totalStudents: 11849},
            {rank: 29, name: "è‡ºåŒ—é†«å­¸å¤§å­¸", percentage: 11.15, foreignStudents: 692, totalStudents: 6204},
            {rank: 30, name: "åœ‹ç«‹æš¨å—åœ‹éš›å¤§å­¸", percentage: 8.80, foreignStudents: 584, totalStudents: 6635},
            {rank: 31, name: "åœ‹ç«‹æ”¿æ²»å¤§å­¸", percentage: 8.79, foreignStudents: 1485, totalStudents: 16899},
            {rank: 32, name: "åœ‹ç«‹æ±è¯å¤§å­¸", percentage: 9.64, foreignStudents: 989, totalStudents: 10266},
            {rank: 33, name: "åœ‹ç«‹æ¸…è¯å¤§å­¸", percentage: 9.62, foreignStudents: 1757, totalStudents: 18269},
            {rank: 34, name: "åœ‹ç«‹è‡ºç£å¤§å­¸", percentage: 9.76, foreignStudents: 3365, totalStudents: 34487},
            {rank: 35, name: "åœ‹ç«‹è‡ºç£å¸«ç¯„å¤§å­¸", percentage: 10.36, foreignStudents: 1722, totalStudents: 16624},
            {rank: 36, name: "å…ƒæ™ºå¤§å­¸", percentage: 9.81, foreignStudents: 894, totalStudents: 9114},
            {rank: 37, name: "æ­£ä¿®ç§‘æŠ€å¤§å­¸", percentage: 9.36, foreignStudents: 1401, totalStudents: 14957},
            {rank: 38, name: "åœ‹ç«‹æˆåŠŸå¤§å­¸", percentage: 8.29, foreignStudents: 1939, totalStudents: 23381},
            {rank: 39, name: "ä¸­åŸå¤§å­¸", percentage: 5.90, foreignStudents: 974, totalStudents: 16510},
            {rank: 40, name: "æ·¡æ±Ÿå¤§å­¸", percentage: 6.37, foreignStudents: 1418, totalStudents: 22276},
            {rank: 41, name: "å¯¦è¸å¤§å­¸", percentage: 6.46, foreignStudents: 666, totalStudents: 10305},
            {rank: 42, name: "éŠ˜å‚³å¤§å­¸", percentage: 12.27, foreignStudents: 2121, totalStudents: 17287},
            {rank: 43, name: "è¼”ä»å¤§å­¸", percentage: 3.76, foreignStudents: 966, totalStudents: 25681},
            {rank: 44, name: "åœ‹ç«‹é™½æ˜äº¤é€šå¤§å­¸", percentage: 5.52, foreignStudents: 1222, totalStudents: 22117},
            {rank: 45, name: "é€¢ç”²å¤§å­¸", percentage: 3.88, foreignStudents: 833, totalStudents: 21462},
            {rank: 46, name: "éœå®œå¤§å­¸", percentage: 7.40, foreignStudents: 786, totalStudents: 10630},
            {rank: 47, name: "æ±æµ·å¤§å­¸", percentage: 5.84, foreignStudents: 911, totalStudents: 15586},
            {rank: 48, name: "ä¸­åœ‹æ–‡åŒ–å¤§å­¸", percentage: 5.09, foreignStudents: 912, totalStudents: 17904},
            {rank: 49, name: "æ±å³å¤§å­¸", percentage: 2.57, foreignStudents: 384, totalStudents: 14958},
            {rank: 50, name: "åœ‹ç«‹ä¸­èˆˆå¤§å­¸", percentage: 4.94, foreignStudents: 783, totalStudents: 15845},
            {rank: 51, name: "é•·åºšå¤§å­¸", percentage: 6.81, foreignStudents: 493, totalStudents: 7241},
            {rank: 52, name: "åœ‹ç«‹ä¸­å¤®å¤§å­¸", percentage: 4.56, foreignStudents: 573, totalStudents: 12563},
            {rank: 53, name: "åœ‹ç«‹ä¸­å±±å¤§å­¸", percentage: 6.90, foreignStudents: 756, totalStudents: 10948},
            {rank: 54, name: "åœ‹ç«‹è‡ºåŒ—ç§‘æŠ€å¤§å­¸", percentage: 7.32, foreignStudents: 988, totalStudents: 13493},
            {rank: 55, name: "åœ‹ç«‹è‡ºç£æµ·æ´‹å¤§å­¸", percentage: 7.21, foreignStudents: 656, totalStudents: 9102},
            {rank: 56, name: "ä¸­è¯å¤§å­¸", percentage: 16.31, foreignStudents: 580, totalStudents: 3557},
            {rank: 57, name: "å¤§è‘‰å¤§å­¸", percentage: 6.19, foreignStudents: 227, totalStudents: 3666},
            {rank: 58, name: "ä¸–æ–°å¤§å­¸", percentage: 4.24, foreignStudents: 468, totalStudents: 11028},
            {rank: 59, name: "é«˜é›„é†«å­¸å¤§å­¸", percentage: 4.68, foreignStudents: 312, totalStudents: 6667},
            {rank: 60, name: "ä¸­åœ‹é†«è—¥å¤§å­¸", percentage: 7.81, foreignStudents: 585, totalStudents: 7492},
            {rank: 61, name: "å—è‡ºç§‘æŠ€å¤§å­¸", percentage: 3.29, foreignStudents: 477, totalStudents: 14507},
            {rank: 62, name: "æ¨¹å¾·ç§‘æŠ€å¤§å­¸", percentage: 11.36, foreignStudents: 934, totalStudents: 8226},
            {rank: 63, name: "æ…ˆæ¿Ÿå¤§å­¸", percentage: 7.34, foreignStudents: 388, totalStudents: 5285},
            {rank: 64, name: "ä¸­å±±é†«å­¸å¤§å­¸", percentage: 2.78, foreignStudents: 199, totalStudents: 7157},
            {rank: 65, name: "è¼”è‹±ç§‘æŠ€å¤§å­¸", percentage: 5.94, foreignStudents: 492, totalStudents: 8280},
            {rank: 66, name: "é•·æ¦®å¤§å­¸", percentage: 4.91, foreignStudents: 234, totalStudents: 4769},
            {rank: 67, name: "å¼˜å…‰ç§‘æŠ€å¤§å­¸", percentage: 5.17, foreignStudents: 585, totalStudents: 11320},
            {rank: 68, name: "å˜‰å—è—¥ç†å¤§å­¸", percentage: 6.84, foreignStudents: 609, totalStudents: 8910},
            {rank: 69, name: "ç„å¥˜å¤§å­¸", percentage: 16.66, foreignStudents: 231, totalStudents: 1387},
            {rank: 70, name: "æ˜å¿—ç§‘æŠ€å¤§å­¸", percentage: 5.20, foreignStudents: 228, totalStudents: 4383},
            {rank: 71, name: "å¤§ä»ç§‘æŠ€å¤§å­¸", percentage: 4.20, foreignStudents: 160, totalStudents: 3809},
            {rank: 72, name: "å¶ºæ±ç§‘æŠ€å¤§å­¸", percentage: 1.89, foreignStudents: 158, totalStudents: 8355},
            {rank: 73, name: "ä¸­åœ‹ç§‘æŠ€å¤§å­¸", percentage: 8.69, foreignStudents: 483, totalStudents: 5561},
            {rank: 74, name: "ä¸­è‡ºç§‘æŠ€å¤§å­¸", percentage: 1.38, foreignStudents: 84, totalStudents: 6102},
            {rank: 75, name: "äºæ´²å¤§å­¸", percentage: 4.70, foreignStudents: 506, totalStudents: 10776},
            {rank: 76, name: "ä½›å…‰å¤§å­¸", percentage: 6.53, foreignStudents: 165, totalStudents: 2525},
            {rank: 77, name: "å°å—æ‡‰ç”¨ç§‘æŠ€å¤§å­¸", percentage: 1.74, foreignStudents: 158, totalStudents: 9088},
            {rank: 78, name: "ä¸­ä¿¡ç§‘æŠ€å¤§å­¸", percentage: 5.81, foreignStudents: 103, totalStudents: 1774},
            {rank: 79, name: "ä¸­è¯é†«äº‹ç§‘æŠ€å¤§å­¸", percentage: 1.32, foreignStudents: 92, totalStudents: 6968},
            {rank: 80, name: "åƒ‘å…‰ç§‘æŠ€å¤§å­¸", percentage: 4.94, foreignStudents: 395, totalStudents: 7995},
            {rank: 81, name: "ç¾å’Œç§‘æŠ€å¤§å­¸", percentage: 2.06, foreignStudents: 92, totalStudents: 4460},
            {rank: 82, name: "é•·åºšç§‘æŠ€å¤§å­¸", percentage: 0.45, foreignStudents: 27, totalStudents: 5988},
            {rank: 83, name: "æ–‡è—»å¤–èªå¤§å­¸", percentage: 4.57, foreignStudents: 313, totalStudents: 6849},
            {rank: 84, name: "è¯å¤ç§‘æŠ€å¤§å­¸", percentage: 8.64, foreignStudents: 71, totalStudents: 822},
            {rank: 85, name: "è‡´ç†ç§‘æŠ€å¤§å­¸", percentage: 3.44, foreignStudents: 374, totalStudents: 10857},
            {rank: 86, name: "åº·å¯§å¤§å­¸", percentage: 0.09, foreignStudents: 3, totalStudents: 3239},
            {rank: 87, name: "å´‡å³å½±è—ç§‘æŠ€å¤§å­¸", percentage: 5.12, foreignStudents: 57, totalStudents: 1114},
            {rank: 88, name: "å°åŒ—æµ·æ´‹ç§‘æŠ€å¤§å­¸", percentage: 5.94, foreignStudents: 215, totalStudents: 3621},
            {rank: 89, name: "äºæ±ç§‘æŠ€å¤§å­¸", percentage: 7.14, foreignStudents: 282, totalStudents: 3950},
            {rank: 90, name: "ä¸­ä¿¡é‡‘èç®¡ç†å­¸é™¢", percentage: 2.94, foreignStudents: 27, totalStudents: 917},
            {rank: 91, name: "å—äºæŠ€è¡“å­¸é™¢", percentage: 0.38, foreignStudents: 7, totalStudents: 1824},
            {rank: 92, name: "é¦¬å•é†«å­¸é™¢", percentage: 1.52, foreignStudents: 15, totalStudents: 986},
            {rank: 93, name: "é¦¬å•é†«è­·ç®¡ç†å°ˆç§‘å­¸æ ¡", percentage: 0.07, foreignStudents: 3, totalStudents: 4046},
            {rank: 94, name: "æ¨¹äººé†«è­·ç®¡ç†å°ˆç§‘å­¸æ ¡", percentage: 0.03, foreignStudents: 2, totalStudents: 7213},
            {rank: 95, name: "è€•è˜å¥åº·ç®¡ç†å°ˆç§‘å­¸æ ¡", percentage: 0.08, foreignStudents: 3, totalStudents: 3931},
            {rank: 96, name: "æ•æƒ é†«è­·ç®¡ç†å°ˆç§‘å­¸æ ¡", percentage: 0.03, foreignStudents: 1, totalStudents: 3306},
            {rank: 97, name: "è–æ¯é†«è­·ç®¡ç†å°ˆç§‘å­¸æ ¡", percentage: 0.42, foreignStudents: 6, totalStudents: 1416},
            {rank: 98, name: "è‡ºåŒ—å¸‚ç«‹å¤§å­¸", percentage: 2.05, foreignStudents: 166, totalStudents: 8099},
            {rank: 99, name: "åœ‹ç«‹ä¸­æ­£å¤§å­¸", percentage: 3.55, foreignStudents: 410, totalStudents: 11553},
            {rank: 100, name: "åœ‹ç«‹é«˜é›„å¸«ç¯„å¤§å­¸", percentage: 2.35, foreignStudents: 171, totalStudents: 7262},
            {rank: 101, name: "åœ‹ç«‹å½°åŒ–å¸«ç¯„å¤§å­¸", percentage: 3.98, foreignStudents: 343, totalStudents: 8624},
            {rank: 102, name: "åœ‹ç«‹è‡ºåŒ—å¤§å­¸", percentage: 5.81, foreignStudents: 589, totalStudents: 10142},
            {rank: 103, name: "åœ‹ç«‹å˜‰ç¾©å¤§å­¸", percentage: 2.53, foreignStudents: 287, totalStudents: 11349},
            {rank: 104, name: "åœ‹ç«‹é«˜é›„å¤§å­¸", percentage: 4.47, foreignStudents: 277, totalStudents: 6192},
            {rank: 105, name: "åœ‹ç«‹é›²æ—ç§‘æŠ€å¤§å­¸", percentage: 3.58, foreignStudents: 375, totalStudents: 10470},
            {rank: 106, name: "åœ‹ç«‹å±æ±ç§‘æŠ€å¤§å­¸", percentage: 4.33, foreignStudents: 433, totalStudents: 10003},
            {rank: 107, name: "åœ‹ç«‹è‡ºåŒ—è—è¡“å¤§å­¸", percentage: 7.03, foreignStudents: 226, totalStudents: 3213},
            {rank: 108, name: "åœ‹ç«‹è‡ºç£è—è¡“å¤§å­¸", percentage: 5.76, foreignStudents: 319, totalStudents: 5539},
            {rank: 109, name: "åœ‹ç«‹è‡ºæ±å¤§å­¸", percentage: 0.95, foreignStudents: 48, totalStudents: 5048},
            {rank: 110, name: "åœ‹ç«‹å®œè˜­å¤§å­¸", percentage: 1.76, foreignStudents: 96, totalStudents: 5447},
            {rank: 111, name: "åœ‹ç«‹è¯åˆå¤§å­¸", percentage: 0.95, foreignStudents: 72, totalStudents: 7594},
            {rank: 112, name: "åœ‹ç«‹è™å°¾ç§‘æŠ€å¤§å­¸", percentage: 1.03, foreignStudents: 123, totalStudents: 11975},
            {rank: 113, name: "åœ‹ç«‹è‡ºå—è—è¡“å¤§å­¸", percentage: 4.45, foreignStudents: 71, totalStudents: 1596},
            {rank: 114, name: "åœ‹ç«‹è‡ºå—å¤§å­¸", percentage: 2.25, foreignStudents: 134, totalStudents: 5966},
            {rank: 115, name: "åœ‹ç«‹è‡ºåŒ—æ•™è‚²å¤§å­¸", percentage: 3.68, foreignStudents: 222, totalStudents: 6039},
            {rank: 116, name: "åœ‹ç«‹è‡ºä¸­æ•™è‚²å¤§å­¸", percentage: 4.02, foreignStudents: 206, totalStudents: 5130},
            {rank: 117, name: "åœ‹ç«‹æ¾æ¹–ç§‘æŠ€å¤§å­¸", percentage: 0.21, foreignStudents: 5, totalStudents: 2388},
            {rank: 118, name: "åœ‹ç«‹å‹¤ç›Šç§‘æŠ€å¤§å­¸", percentage: 7.43, foreignStudents: 929, totalStudents: 12510},
            {rank: 119, name: "åœ‹ç«‹é«”è‚²å¤§å­¸", percentage: 2.52, foreignStudents: 70, totalStudents: 2782},
            {rank: 120, name: "åœ‹ç«‹è‡ºåŒ—è­·ç†å¥åº·å¤§å­¸", percentage: 2.67, foreignStudents: 139, totalStudents: 5201},
            {rank: 121, name: "åœ‹ç«‹é«˜é›„é¤æ—…å¤§å­¸", percentage: 7.80, foreignStudents: 320, totalStudents: 4101},
            {rank: 122, name: "åœ‹ç«‹é‡‘é–€å¤§å­¸", percentage: 6.25, foreignStudents: 239, totalStudents: 3823},
            {rank: 123, name: "åœ‹ç«‹è‡ºç£é«”è‚²é‹å‹•å¤§å­¸", percentage: 3.04, foreignStudents: 94, totalStudents: 3090},
            {rank: 124, name: "åœ‹ç«‹è‡ºä¸­ç§‘æŠ€å¤§å­¸", percentage: 1.81, foreignStudents: 286, totalStudents: 15762},
            {rank: 125, name: "åœ‹ç«‹è‡ºåŒ—å•†æ¥­å¤§å­¸", percentage: 2.98, foreignStudents: 207, totalStudents: 6948},
            {rank: 126, name: "åœ‹ç«‹å±æ±å¤§å­¸", percentage: 1.40, foreignStudents: 122, totalStudents: 8740},
            {rank: 127, name: "åœ‹ç«‹é«˜é›„ç§‘æŠ€å¤§å­¸", percentage: 1.81, foreignStudents: 495, totalStudents: 27394},
            {rank: 128, name: "åœ‹ç«‹è‡ºç£æˆ²æ›²å­¸é™¢", percentage: 1.11, foreignStudents: 5, totalStudents: 449},
            {rank: 129, name: "åœ‹ç«‹è‡ºå—è­·ç†å°ˆç§‘å­¸æ ¡", percentage: 0.20, foreignStudents: 4, totalStudents: 1992},
            {rank: 130, name: "çœŸç†å¤§å­¸", percentage: 14.39, foreignStudents: 334, totalStudents: 2322},
            {rank: 131, name: "å¤§åŒå¤§å­¸", percentage: 2.44, foreignStudents: 85, totalStudents: 3490},
            {rank: 132, name: "å—è¯å¤§å­¸", percentage: 3.54, foreignStudents: 166, totalStudents: 4690},
            {rank: 133, name: "è¯æ¢µå¤§å­¸", percentage: 7.15, foreignStudents: 76, totalStudents: 1063}
        ];

        let currentSortType = 'percentage';

        // æ ¼å¼åŒ–æ•¸å­—
        function formatNumber(num) {
            return num.toLocaleString('zh-TW');
        }

        // ç²å–ç™¾åˆ†æ¯”é¡è‰²é¡åˆ¥
        function getPercentageClass(percentage) {
            if (percentage >= 15) return 'high-percentage';
            if (percentage >= 8) return 'medium-percentage';
            return 'low-percentage';
        }

        // è¼‰å…¥è¡¨æ ¼è³‡æ–™
        function loadTableData(data = foreignStudentData) {
            const tbody = document.getElementById('tableBody');
            tbody.innerHTML = '';

            data.forEach((school, index) => {
                const row = document.createElement('tr');
                const percentageClass = getPercentageClass(school.percentage);

                row.innerHTML = `
                    <td class="rank">${currentSortType === 'percentage' ? school.rank : index + 1}</td>
                    <td class="school-name">${school.name}</td>
                    <td class="percentage ${percentageClass}">${school.percentage.toFixed(2)}%</td>
                    <td class="student-count">${formatNumber(school.foreignStudents)}</td>
                    <td class="student-count">${formatNumber(school.totalStudents)}</td>
                `;
                tbody.appendChild(row);
            });
        }

        // æ’åºå‡½æ•¸
        function sortByPercentage() {
            const sorted = [...foreignStudentData].sort((a, b) => b.percentage - a.percentage);
            loadTableData(sorted);
            updateActiveButton('sortByPercentage');
            currentSortType = 'percentage';
        }

        function sortByForeignNumber() {
            const sorted = [...foreignStudentData].sort((a, b) => b.foreignStudents - a.foreignStudents);
            loadTableData(sorted);
            updateActiveButton('sortByForeignNumber');
            currentSortType = 'foreignNumber';
        }

        function sortByTotalNumber() {
            const sorted = [...foreignStudentData].sort((a, b) => b.totalStudents - a.totalStudents);
            loadTableData(sorted);
            updateActiveButton('sortByTotalNumber');
            currentSortType = 'totalNumber';
        }

        function sortByName() {
            const sorted = [...foreignStudentData].sort((a, b) => a.name.localeCompare(b.name, 'zh-TW'));
            loadTableData(sorted);
            updateActiveButton('sortByName');
            currentSortType = 'name';
        }

        function updateActiveButton(activeFunction) {
            document.querySelectorAll('.sort-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
        }

        // åŒ¯å‡ºExcel
        function exportToExcel() {
            const worksheet = XLSX.utils.json_to_sheet(
                foreignStudentData.map(school => ({
                    'æ’å': school.rank,
                    'å­¸æ ¡åç¨±': school.name,
                    'å¤–ç±å­¸ç”Ÿæ¯”ä¾‹(%)': school.percentage.toFixed(2),
                    'å¤–ç±å­¸ç”Ÿäººæ•¸': school.foreignStudents,
                    'ç¸½å­¸ç”Ÿäººæ•¸': school.totalStudents
                }))
            );

            const workbook = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(workbook, worksheet, 'å¤–ç±å­¸ç”Ÿæ¯”ä¾‹çµ±è¨ˆ');

            // è¨­å®šæ¬„ä½å¯¬åº¦
            worksheet['!cols'] = [
                { width: 8 },   // æ’å
                { width: 30 },  // å­¸æ ¡åç¨±
                { width: 18 },  // å¤–ç±å­¸ç”Ÿæ¯”ä¾‹
                { width: 15 },  // å¤–ç±å­¸ç”Ÿäººæ•¸
                { width: 15 }   // ç¸½å­¸ç”Ÿäººæ•¸
            ];

            XLSX.writeFile(workbook, '113å­¸å¹´åº¦å„å¤§å°ˆæ ¡é™¢å¤–ç±å­¸ç”Ÿæ¯”ä¾‹çµ±è¨ˆ.xlsx');
        }

        // åŒ¯å‡ºCSV
        function exportToCSV() {
            const csvContent = [
                ['æ’å', 'å­¸æ ¡åç¨±', 'å¤–ç±å­¸ç”Ÿæ¯”ä¾‹(%)', 'å¤–ç±å­¸ç”Ÿäººæ•¸', 'ç¸½å­¸ç”Ÿäººæ•¸'],
                ...foreignStudentData.map(school => [
                    school.rank,
                    school.name,
                    school.percentage.toFixed(2),
                    school.foreignStudents,
                    school.totalStudents
                ])
            ].map(row => row.join(',')).join('\n');

            const blob = new Blob(['\uFEFF' + csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = '113å­¸å¹´åº¦å„å¤§å°ˆæ ¡é™¢å¤–ç±å­¸ç”Ÿæ¯”ä¾‹çµ±è¨ˆ.csv';
            link.click();
        }

        // é é¢è¼‰å…¥æ™‚åŸ·è¡Œ
        document.addEventListener('DOMContentLoaded', function() {
            loadTableData();
        });
    </script>
</body>
</html>
